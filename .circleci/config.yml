version: 2
jobs:
  build:
    docker:
      - image: circleci/node:8.10.0
    steps:
      - checkout
      - run:
          name: Check Yarn Version
          command: yarn --version
      - run:
          name: Install and Link Packages
          command: yarn install
      - run:
          name: Run Tests and Typecheck
          command: yarn run check
      - run:
          name: Authenticate with registry
          command: echo "//registry.npmjs.org/:_authToken=$NPM_TOKEN" > .npmrc
      - run:
          name: Publish to Npm If Requested
          command: node scripts/publish.js